---
title: "RPart2_Homework"
author: "Alex Baransky"
output: html_document
---
## Question #1	

Each new term in the Fibonacci sequence is generated by adding the previous two terms. Starting with 1 and 2, the first 10 Fibonacci numbers are:

1, 2, 3, 5, 8, 13, 21, 34, 55, 89,...

Consider all the Fibonacci numbers whose values do not exceed four million. Find the sum of even-valued terms among them.

```{r Question 1}
x = 1
y = 1
fib = c()
while (x < 4000000 & y < 4000000){
    x = x + y
    y = x + y
    fib = c(fib, x, y)
}
sum(fib[fib %% 2 == 0 & fib < 4000000])
```

## Question #2

Write your own code to implement the multiplication between a matrix and a vector. In case you forget it, here's the definition of matrix multiplication. For an m?n matrix A and an n-dimensional vector x, y = Ax is an m-dimensional vector, where 
\begin{align}y[i] = \sum_{j=1}^nA[i,j]x[j] \text{ for } i = 1,2,3,...m\end{align}

```{r Question 2}
matrix_vector_mult = function(in_mat, in_vec){
  if (dim(in_mat)[2] != length(in_vec)){
    print('Your dimensions do not match! Please enter an m X n matrix and an n-dimensional vector.')
  }
  else {
    y = 1:dim(in_mat)[1]
  
    for (i in 1:dim(in_mat)[1]){
      sum = 0
      for (j in 1:dim(in_mat)[2]){
        temp = in_mat[i,j]*in_vec[j]
        sum = sum + temp
      }
      y[i] = sum
    }
  return(y)
  }
}

my_mat = matrix(1:16, 4)
my_vec = seq(2, 8, by=2)
matrix_vector_mult(my_mat, my_vec)
```


## Question #3:

Write a function that calculates the median absolute deviation (MAD) of a numeric vector. The median absolute deviation is a robust alternative to standard deviation as a measure of dispersion. For vector X, it is defined as  
$$MAD = median(|X_i-median(X)|)$$
```{r Question 3}
find_mad = function(x){
  if (!is.numeric(x)){
    print('Please eneter a numeric vector.')
  }
  else{
    temp_vec = 1:length(x)
    for (i in length(x)){
      temp_vec[i] = abs(x[i] - median(x))
    }
    return(median(temp_vec))
  }
}

my_vec = seq(1,31, by=3)
find_mad(my_vec)
```


## Question #4: 

Suppose we have a  character vector as follows: `Names <- "John Andrew Thomas"`
Write some R code to obtain the following output:

\begin{align}\text{"John@gmail.com; Andrew@gmail.com; Thomas@gmail.com"}\end{align}

```{r Question 4}
names_to_email = function(names){
  if (!is.character(names)){
    print('Please enter a character vector of names!')
  }
  else{
    split_names = strsplit(names, split = ' ', fixed = TRUE)
    email_list = sapply(split_names, function(x) paste0(x, '@gmail.com'))
    return(paste(email_list, collapse = '; '))
  }
}
Names <- "John Andrew Thomas"
names_to_email(Names)
```

## Question #5:

Write R code to generate a vector with the following elements, **without using loops**.

"aa" "ba" "ca" "da" "ea" "ab" "bb" "cb" "db" "eb" "ac" "bc" "cc" "dc" "ec" "ad" "bd" "cd" "dd" "ed" "ae" "be" "ce" "de" "ee"

```{r Question 5}
paste_chars <- function(char_vec){
	perms = sapply(char_vec, function(x) sapply(char_vec, function(y) paste0(y,x)))
	return(as.vector(perms))
}
paste_chars(c('a', 'b', 'c', 'd', 'e'))
```

## Question #6:

Write an R function named `compare` which takes two words as arguments/inputs and returns "Equal Length" if the number of characters are equal in two words and "Not Equal Length" otherwise. It should work as following: 
```
>>compare("EPS568","Summer") 
"Equal Length"					
>>compare("EPS568","SummerA") 
"Not Equal Length"
```
```{r Question 6}
compare = function(first, second){
  if (nchar(first) == nchar(second)){
    print('Equal Length')
  }
  else{
    print('Not Equal Length')
  }
}
compare("EPS568","Summer")
compare("EPS568","SummerA")
```

## Challenge Question:

The game of craps is played as follows:

* Roll two six-sided dice; let x be the sum of the dice on the first roll.
* If x is 7 or 11, you automatically win.
* If x is 2, 3 or 12, you lose.
* If x is any other value (4, 5, 6, 8, 9, 10), x is then called the "point". Continue to re-roll the dice until you either roll the "point" again or a 7. 
    + If you obtain the established point x again, you win.
    + If a 7 is rolled before the point, you lose.


1. Write an R function to play this game once all the way through. You can use the expression 
`x <- sum(sample(1:6, 2, replace=T))` 
to simulate the sum of two rolled dice. The outcome of this expression should be a character element of either "Win" or "Loss".

2. Now, use the R expression you develop in (1), and repeat this game 1000 times hypothetically using a *for loop*. You should save the result of 1000 games in a vector with each element is either "Win" or "Loss". 

```{r Challenge Question}
system.time({
roll = function(){
  return(sum(sample(1:6, 2, replace=T)))
}

play_craps = function(){
  x = roll()
  if (x == 7 | x == 11){
    return('Win')
  }
  else if (x == 2 | x == 3 | x == 12){
    return('Loss')
  }
  else{
    point = x
    while (TRUE){
      x = roll()
      if (x == point){
        return('Win')
      }
      else if (x == 7){
        return('Loss')
      }
    }
  }
}
outcomes = 1:1000000
for (i in outcomes){
  outcomes[i] = play_craps()
}
head(outcomes)
print(length(grep('Win', outcomes)))
})
```





